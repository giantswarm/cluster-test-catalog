{
    "$schema": "http://json-schema.org/schema#",
    "$id": "values.schema.json",
    "$defs": {
        "gvk": {
            "type": "object",
            "title": "Schema for Kubernetes API group, version and kind",
            "description": "It can be used to specify which CustomResourceDefinition is used.",
            "required": [
                "group",
                "version",
                "kind"
            ],
            "properties": {
                "group": {
                    "type": "string",
                    "title": "API group",
                    "examples": [
                        "cluster.x-k8s.io",
                        "controlplane.cluster.x-k8s.io",
                        "infrastructure.cluster.x-k8s.io"
                    ]
                },
                "kind": {
                    "type": "string",
                    "title": "API kind",
                    "examples": [
                        "Cluster",
                        "KubeadmControlPlane"
                    ]
                },
                "version": {
                    "type": "string",
                    "title": "API version",
                    "examples": [
                        "v1alpha1",
                        "v1alpha2",
                        "v1beta1",
                        "v1"
                    ]
                }
            }
        }
    },
    "type": "object",
    "additionalProperties": false,
    "properties": {
        "metadata": {
            "type": "object",
            "title": "Metadata",
            "additionalProperties": false,
            "properties": {
                "annotations": {
                    "type": "object",
                    "title": "Annotations",
                    "description": "These annotations are added to all Kubernetes resources defining this cluster.",
                    "additionalProperties": false,
                    "patternProperties": {
                        "^([a-zA-Z0-9\\.-]{1,253}\/)?[a-zA-Z0-9\\._-]{1,63}$": {
                            "type": "string",
                            "title": "Annotation",
                            "minLength": 1
                        }
                    }
                },
                "description": {
                    "type": "string",
                    "title": "Cluster description",
                    "description": "User-friendly description of the cluster's purpose."
                },
                "labels": {
                    "type": "object",
                    "title": "Labels",
                    "description": "These labels are added to all Kubernetes resources defining this cluster.",
                    "additionalProperties": false,
                    "patternProperties": {
                        "^[a-zA-Z0-9/\\._-]+$": {
                            "type": "string",
                            "title": "Label",
                            "maxLength": 63,
                            "minLength": 0,
                            "pattern": "^[a-zA-Z0-9\\._-]+$"
                        }
                    }
                },
                "name": {
                    "type": "string",
                    "title": "Cluster name",
                    "description": "Unique identifier, cannot be changed after creation.",
                    "readOnly": true
                },
                "organization": {
                    "type": "string",
                    "title": "Organization",
                    "description": "The name of organization that owns the cluster.",
                    "readOnly": true
                },
                "servicePriority": {
                    "type": "string",
                    "title": "Service priority",
                    "description": "The relative importance of this cluster.",
                    "$comment": "Defined in https://github.com/giantswarm/rfc/tree/main/classify-cluster-priority",
                    "enum": [
                        "highest",
                        "medium",
                        "lowest"
                    ],
                    "default": "highest"
                }
            },
            "required": [
                "description",
                "name",
                "organization",
                "servicePriority"
            ]
        },
        "connectivity": {
            "type": "object",
            "title": "Connectivity",
            "additionalProperties": false,
            "properties": {
                "network": {
                    "type": "object",
                    "title": "Network",
                    "additionalProperties": false,
                    "properties": {
                        "pods": {
                            "type": "object",
                            "title": "Pods",
                            "additionalProperties": false,
                            "properties": {
                                "cidrBlocks": {
                                    "type": "array",
                                    "title": "Pod subnets",
                                    "items": {
                                        "type": "string",
                                        "title": "Pod subnet",
                                        "description": "IPv4 address range for pods, in CIDR notation.",
                                        "examples": [
                                            "10.244.0.0/16"
                                        ]
                                    },
                                    "default": [
                                        "100.64.0.0/12"
                                    ],
                                    "maxItems": 1,
                                    "minItems": 1
                                }
                            }
                        },
                        "services": {
                            "type": "object",
                            "title": "Services",
                            "additionalProperties": false,
                            "properties": {
                                "cidrBlocks": {
                                    "type": "array",
                                    "title": "Kubernetes Service subnets",
                                    "items": {
                                        "type": "string",
                                        "title": "Service subnet",
                                        "description": "IPv4 address range for kubernetes services, in CIDR notation.",
                                        "examples": [
                                            "172.31.0.0/16"
                                        ]
                                    },
                                    "default": [
                                        "172.31.0.0/16"
                                    ],
                                    "maxItems": 1,
                                    "minItems": 1
                                }
                            }
                        }
                    }
                }
            }
        },
        "internal": {
            "type": "object",
            "title": "Internal",
            "additionalProperties": false,
            "properties": {
                "controlPlane": {
                    "type": "object",
                    "title": "Internal control plane configuration",
                    "additionalProperties": false,
                    "properties": {
                        "resources": {
                            "type": "object",
                            "title": "Resources configuration",
                            "description": "GVK and other configuration for control plane resources.",
                            "additionalProperties": false,
                            "properties": {
                                "controlPlane": {
                                    "type": "object",
                                    "title": "Control plane resource config",
                                    "additionalProperties": false,
                                    "properties": {
                                        "api": {
                                            "$ref": "#/$defs/gvk"
                                        }
                                    },
                                    "default": {
                                        "api": {
                                            "group": "controlplane.cluster.x-k8s.io",
                                            "version": "v1beta1",
                                            "kind": "KubeadmControlPlane"
                                        }
                                    },
                                    "required": [
                                        "api"
                                    ]
                                }
                            },
                            "required": [
                                "controlPlane"
                            ]
                        }
                    },
                    "required": [
                        "resources"
                    ]
                },
                "kubernetesVersion": {
                    "type": "string",
                    "title": "Kubernetes version",
                    "examples": [
                        "1.24.7"
                    ],
                    "default": "1.24.10"
                },
                "operatingSystem": {
                    "type": "string",
                    "title": "Operating system",
                    "enum": [
                        "flatcar",
                        "ubuntu"
                    ],
                    "default": "flatcar",
                    "example": "flatcar"
                },
                "paused": {
                    "type": "boolean",
                    "title": "Paused",
                    "default": false
                },
                "providerSpecific": {
                    "type": "object",
                    "title": "Internal provider specific configuration",
                    "additionalProperties": false,
                    "properties": {
                        "resources": {
                            "type": "object",
                            "title": "Resources configuration",
                            "description": "GVK and other configuration for provider-specific infrastructure resources.",
                            "additionalProperties": false,
                            "properties": {
                                "cluster": {
                                    "type": "object",
                                    "title": "Provider specific cluster resource",
                                    "properties": {
                                        "api": {
                                            "$ref": "#/$defs/gvk"
                                        }
                                    },
                                    "default":{
                                        "api": {
                                            "group": "infrastructure.cluster.x-k8s.io",
                                            "version": "v1beta1"
                                        }
                                    },
                                    "required": [
                                        "api"
                                    ]
                                }
                            },
                            "required": [
                                "cluster"
                            ]
                        }
                    },
                    "required": [
                        "resources"
                    ]
                }
            },
            "required":[
                "controlPlane",
                "kubernetesVersion",
                "operatingSystem",
                "paused",
                "providerSpecific"
            ]
        }
    }
}
